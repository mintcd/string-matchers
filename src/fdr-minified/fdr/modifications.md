I need a more manageable code to study and so that my Python simulation is not much less performant.

1. Remove Teddy
2. Remove flood detection
3. Only use stride=1
4. Inline FDR_MAIN_LOOP
5. Rename `*s` to `*state`