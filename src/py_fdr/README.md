This version uses strings for texts and patterns. 